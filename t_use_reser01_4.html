<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>시즌이용권</title>
    <script src="./jquery.js"></script>
    <style>
      :root {
        --sf02-inputbox-height: 400px;
      }
      .season_fieldset01 {
        position: relative;
        padding: 80px 15% 30px;
      }
      .season_fieldset01 legend::before {
        content: "01";
        display: inline-block;
        text-align: center;
        vertical-align: middle;
        line-height: 1.5;
        width: 30px;
        height: 30px;
        background-color: royalblue;
        border-radius: 50%;
        font-size: 18px;
        color: white;
        margin-right: 10px;
      }
      .sf01_labelexp{
        width: 100%;
      }
      .sf01_labelexp ul {
        width: 100%;
      }
      .sf01_labelexp>ul>li {
        width: 100%;
        display: flex;
        justify-content: space-evenly;
        word-break: keep-all;

        padding: 15px;
      }
      .sf01_labelexp_img {
        width: 35%;
      }
      .sf01_labelexp img {
        width: 100%
      }
      .sf01_labelexp_title strong{
        display: block;
        font-size: 200%;
        padding-bottom: 10px;
      }
      .sf01_labelexp_title span{
        display: block;
        font-size: 100%;
        font-weight: 600;
      }
      .sf01_labelexp_detail{
        padding-top: 20px;
      }
      .sf01_labelexp_detail li {
        list-style: circle;
        margin-left: 30px;

      }
      .sf01_labelexp_detail span {
        display: block;
        text-indent: 10px;
        color: #666;
      }
      .sf01_tcWrap {
        display: flex;
        justify-content: center;
        position: relative;
        box-sizing: border-box;
        width: 100%;
        gap: 15px;
        padding-bottom: 20px;
      }
      .sf01_ticketcard {
        position: relative;
        box-sizing: border-box;
        border-radius: 20px;
        width: calc(100% / 3 + 10px);
        aspect-ratio: 1 / 1.2;
        overflow: hidden;
        box-shadow: 3px 3px 6px rgba(136, 136, 136, 0.5);
      }
     
      .sf01_tc_select{
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
        box-sizing: content-box;
        aspect-ratio: 1 / 0.6;
        margin-bottom: 5px;
      }
      .sf01_tc_select img {
        width: 108%;
      }
      .sf01_tc_title {
        display: block;
        text-align: start;
        font-size: 150%;
        font-weight: 600;

        padding: 10px 20px;
      }
      .sf01_tc_disabled{
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 1em;
        position: absolute;
        top: 0px;
        left: 0px;
        background-color: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(2px);
      }
      .sf01_tc_disabled strong:first-child{
        font-size: 150%;
      }
      .sf01_exp {
        padding-top: 30px;
        width: 100%;
        box-sizing: border-box;
      }
      .sf01_exp dl {
        padding: 5%;
        width: fit-content;
        margin: auto;
        border: 1px solid rgb(102, 102, 102,0.3);
      }
      .sf01_exp dt {
        font-size: 150%;
        font-weight: 500;
        padding-bottom: 1em;
      }
      .sf01_exp dd {
        color: #666;
        padding: 0.2em;
        width: max-content;
      }
      .sf01_exp dd::before {
        content: "-";
        display: inline-block;
        height: fit-content;
        padding:0px 10px;
      }
      
    /* ----------------------------------------- */
    .season_fieldset02 {
      position: relative;
      padding: 80px 15% 30px;
    }
    .season_fieldset02 legend::before {
      content: "02";
      display: inline-block;
      text-align: center;
      vertical-align: middle;
      line-height: 1.5;
      width: 30px;
      height: 30px;
      background-color: royalblue;
      border-radius: 50%;
      font-size: 18px;
      color: white;
      margin-right: 10px;
    }
    .sf02_i_info_origin {
      display: none;
    }
    .sf02_i_i_tab {
      height: 80px;
      background-color: white;
      position: relative;
      padding-left: 70px;
      display: flex;
      align-items: center;
    }
    .sf02_i_i_tab > a {
      display: block;
      font-size: 0px;
      width: 15px;
      height: 15px;
      background: #eee url("./img/close_button.png") no-repeat center/90%;
      border: 2px solid #666;
      position: absolute;
      left: 20px;
    }
    .sf02_i_i_inputpage_wrap {
      height: var(--sf02-inputbox-height);
      border: 2px solid white;
    }
    .sf02_i_i_inputpage {
      box-sizing: border-box;
      height: var(--sf02-inputbox-height);
      padding: 20px 10px;
      margin:auto;
      display: flex;
      flex-wrap: wrap;
      flex-direction: column;
      align-content: start;
      transition: .5s ease;
    }
    .sf02_i_i_inputpage > div:not(.user_photo) {
      border: 1px dashed tomato;
      position: relative;
      height: calc(100% / 4);
      width: calc(100% / 3);
      box-sizing: border-box;
    }
    .sf02_i_i_inputpage input {
      background-color: transparent;
      border: none;
      border: 1px solid #666;
      border-radius: 15px;
      padding: 17px 0px 9px 20px ;
      box-sizing: border-box;
      width: 250px;
      font-size: 15px;
      outline-color:rgb(2, 172, 2);
      transition: .5s ease;
    }
    .sf02_i_i_inputpage input::placeholder {
      opacity: 0.7;
    }
    .sf02_i_i_inputpage input:focus {
      border-color: yellow;
    }
    .sf02_i_i_inputpage label:not(.user_birthday label),
    .user_birthday span {
      display: inline-block;
      position: absolute;
      top: -10px;
      left: 0px;
      font-size: 12px;
      color: #666;
      background-color: var(--inputbox-bg-color);
      padding: 0px 3px;
    }
    .user_nationality_select {
      position: relative;
    }
    .user_nationality_select ul {
      display: none;

      list-style: none;
      padding: 0px;
      margin: 0px;
      width: 200px;
      background-color: white;
      border: 2px solid #ffffff41;
      border-radius: 15px;
      box-sizing: border-box;
      position: absolute;
      top: 45px;
      left: 0px;
      z-index: 9000;
    }
    .user_nationality_select li {
      padding: 3px 0px 3px 15px;
      
    }
    .user_nationality_select li a {
      display: block;
      width: 100%;
    }
    .user_nationality_select li:first-child {
      border-top-left-radius: 15px;
      border-top-right-radius: 15px;
    }
    .user_nationality_select li:last-child {
      border-bottom-left-radius: 15px;
      border-bottom-right-radius: 15px;
      padding-bottom: 5px;
    }
    .user_nationality_select li:hover {
      background-color: #ddd;
    }
    .user_nationality_select input {
      
      background: url("img/arrow_drop_down.png") no-repeat center right 8px / 20px 30px;
      width: 200px;
      
    }
    .user_birthday input:nth-of-type(1) {
      width: 70px;
      text-align: center;
      padding-left: 0px;
    }
    .user_birthday input:nth-of-type(2),
    .user_birthday input:nth-of-type(3) {
      width: 50px;
      text-align: center;
      padding-left: 0px;
    }
    .user_photo {
      border: 1px dashed tomato;
      position: relative;
      height: inherit;
      width: calc(100% / 3);
      box-sizing: border-box;
    }
    .user_photo_img_wrap {
      width: 100%;
      aspect-ratio: 1 / 1;
      margin: 10px auto;
      border: 1px dashed royalblue;
      box-sizing: border-box;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .user_photo_canvas {
      border: 1px dashed royalblue;
      box-sizing: border-box;
    }
    .user_photo_cut {
      display: none;

      border: 2px solid red;
      box-sizing: border-box;
      aspect-ratio: 1 / 1;
      width: 50px;
      min-width: 40px;
      min-height: 40px;
      position: absolute;
      top: 0;
      left: 0;
    }
    .user_photo_cut_size {
      width: 15px;
      aspect-ratio: 1/1;
      margin: 2px;
      background-color: red;
      position: absolute;
      bottom: -10px;
      right: -10px;
      opacity: 0;
    }
    .user_photo_cut_size:hover {
      opacity: 1;
      cursor:nwse-resize;
    }
    /* ----------------------------------------- */
    .season_fieldset06 {
      display: flex;
      position: relative;
      padding: 80px 15% 30px;
      gap: 30px;
    }
    .sf06_discount {
      width: 50%;
    }
    .sf06_d_list {
      list-style: none;
      padding: 0px;
      border: 1px solid rgba(0,0,0,0.4);
      border-bottom: none;
    }
    .sf06_d_list .empty_li {
      height: 70px;
      background-color: #eeeeeea4;
      display: flex;
      justify-content: center;
      align-items: center;

      color: #bbb;
    }
      .sf06_d_list li {
        border-bottom: 1px solid rgba(0,0,0,0.4);
      }
      .sf06_d_l_wrap {
        position: relative;
        display: flex;
        align-items:flex-start;
        flex-direction: column;
      }
      .sf06_d_l_listopen {
        display: block;
        width: 50%;
        background: url("img/arrow_drop_down.png") no-repeat center left/30px;
        padding-left: 30px;
        line-height: 2;
        text-decoration: none;
        color: black;
      }
      .sf06_d_l_select {
        position: absolute;
        top: 0px;
        right: 0px;
      }
      .sf06_d_l_detail {
        display: none;
      }
        .sf06_d_l_detail table {
          border: 1px solid rgb(121, 121, 121);
          box-sizing: border-box;
        }
        .sf06_d_l_detail th {
          background-color: rgb(187, 255, 255);
        }
        .sf06_d_l_detail tr {
          background-color: rgb(207, 255, 255);
        }

      .sf06_d_l_w_exp {
        color: var(--exp-color);
        padding-left: 20px;
        font-size: 15px;
      }
      .active_discount {
        background-color: rgb(247, 206, 199);
      }
      .not_discount .sf06_d_l_wrap {
        opacity: 0.5;
      }
      .sf06_d_list li input[type="checkbox"] {
        display: block;
      }

      .sf06_price {
        width: 50%;
      }
      /* ------------------ */
      .sf06_p_s_numbers > div {
        display: none;
      }
      .sf06_discount_select {
        display: none;
      }
      .sf06_p_s_discount >div {
        border: 1px solid tomato;
      }
      #season_total_price {
        display: none;
      }
    </style>
</head>
<body>
    <div class="ticket_formWrap season_ticket_formWrap">
        <div class="season_form_title form_title">
            <h4>시즌이용권 구매하기</h4>
            <div>
              <ul>
                <li></li>
              </ul>
            </div>
        </div>
        <form action="" id="season_ticket_form" class="ticket_form">

          <fieldset class="season_fieldset01">
            <legend>이용권 선택</legend>
            <div class="sf01_labelexp">
              <ul>
                <li>
                  <div class="sf01_labelexp_img">
                    <img src="./img/season_pass.jpg" alt="">
                  </div>
                  <div>
                    <div class="sf01_labelexp_title">
                      <strong>SUMMER 시즌 패스</strong>
                      <span>8만 9천원으로! 여름을 신나게!<br/>
                        내 마음대로 무제한으로 즐길 수 있는 "갓성비" 시즌패스!<br/>
                        오직 6월 30일까지 기간 한정 판매!</span>
                    </div>
                    <div class="sf01_labelexp_detail">
                      <ul>
                        <li>판매가: 8만 9천원</li>
                        <li>판매일: 2023년 5월 12일 ~ 6월 30일</li>
                        <li>이용 기간: 2023년 6월 12일 ~ 9월 3일 (총 84일)</li>
                        <li>이용 제한일: 별도 없음</li>
                        <li>
                          방문 예약 후 파크 입장 가능
                          <span>( 방문 예약 시작일자 : 2023년 5월 12일 이후 )</span>
                        </li>
                      </ul>
                    </div>
                  </div>
                </li>
                <li>
                  <div class="sf01_labelexp_img">
                    <img src="./img/spring-season-pass-1.webp" alt="">
                  </div>
                  <div>
                    <div class="sf01_labelexp_title">
                      <strong>SPRING 시즌 패스</strong>
                      <span>봄 시즌을 무제한*으로 즐길 수 있는 갓성비 시즌패스!<br/>
                        오직 3월 23일까지 기간 한정 판매! (*입장 제한일 적용)</span>
                    </div>
                    <div class="sf01_labelexp_detail">
                      <ul>
                        <li>판매일: 2023년 2월 24일 ~ 3월 23일</li>
                        <li>이용기간: 2023년 3월 24일 ~ 6월 11일 (총 76일)</li>
                        <li>이용 제한일: 2023년 5월 5일 ~ 6일, 6월 4일 (총 3일)</li>
                        <li>방문예약 후 파크 입장 가능
                          <span>( 방문 예약 일자 : 2023년 3월 10일 이후 )</span>
                        </li>
                      </ul>
                    </div>
                  </div>
                </li>
              </ul>
            </div>
            <div class="sf01_tcWrap">
              <div class="sf01_ticketcard summer">
                <a href="#none" class="sf01_tc_select">
                  <img src="./img/summer_season_re.png" alt="">
                </a>
                <span class="sf01_tc_title">SUMMER SEASON PASS</span>
                <div class="sf01_tc_number">
                  <div class="numberCheck">
                    <input
                      type="text"
                      name="season_summer_number"
                      id="season_summer_number"
                      value="0"
                      readonly
                    />
                    <a href="#none" class="decrease_btn">수량 제외<img src="./img/minus.png" alt=""></a>
                    <a href="#none" class="increase_btn">수량 추가<img src="./img/plus.png" alt=""></a>
                  </div>
                </div>
                <div class="sf01_tc_exp">
                  ￦ 89,000
                </div>
              </div>
              <div class="sf01_ticketcard spring">
                <a href="#none" class="sf01_tc_select">
                  <img src="./img/spring_season_re.jpg" alt="">
                </a>
                <span class="sf01_tc_title">SPRING SEASON PASS</span>
                <div class="sf01_tc_number">
                  <div class="numberCheck">
                    <input
                      type="text"
                      name="season_spring_number"
                      id="season_spring_number"
                      value="0"
                      readonly
                    />
                    <a href="#none" class="decrease_btn">수량 제외<img src="./img/minus.png" alt=""></a>
                    <a href="#none" class="increase_btn">수량 추가<img src="./img/plus.png" alt=""></a>
                  </div>
                </div>
                <div class="sf01_tc_exp">
                </div>
                <div class="sf01_tc_disabled">
                  <strong>다음 시즌에 만나요!</strong>
                  <strong>이용권 판매 종료</strong>
                  <span>2023년 2월 24일 ~ 2023년 3월 23일</span>
                </div>
              </div>
            </div>
            <div class="sf01_exp">
              <dl>
                <dt>유의사항</dt>
                <dd>식음료, 리테일 및 호텔 할인 등 별도 혜택 미적용 상품</dd>
                <dd>유효기간 내 현장 매표소에서 연간 이용권(골드, 플래티넘)으로 차액 결제 후 업그레이드 가능</dd>
                <dd>방문 예약 후 파크 입장 가능</dd>
                <dd>만12세 이하 어린이는 입장 및 이용 시 만16세 이상의 보호자 동반 입장 필수</dd>
                <dd>주차장 이용료 별도 부과</dd>
                <dd>천재지변, 악천후, 기구 안전 점검, 내부 공사 사정 등에 따라 파크 미운영일이 발생할 수 있음</dd>
                <dd>이후 일자에 대한 시즌패스 출시 예정</dd>
                <dd>시즌패스는 구매일과 관계없이 만료일이 동일하며, 썸머패스는 9월 3일 일괄 자동 만료</dd>
              </dl>
            </div>
          </fieldset>

          <fieldset class="season_fieldset02">
            <legend>정보 입력</legend>
            <div class="sf02_wrap">
              <div class="sf02_inputBox">
                <div class="sf02_i_info_origin">
                  <div class="sf02_i_i_tab">
                    <div class="sf02_i_i_t_name"></div>
                    <div class="sf02_i_i_t_ticket"></div>
                    <div class="sf02_i_i_t_age"></div>
                    <a href="#none">취소</a>
                  </div>
                  <div class="sf02_i_i_inputpage_wrap">
                    <div class="sf02_i_i_inputpage">
                      <div class="user_name">
                        <label for="">이름</label>
                        <input type="text" name="user_name" id="" >
                      </div>
                      <div class="user_birthday">
                        <span>생년월일</span>
                        <input type="number" name="user_birthYear" maxlength="4" placeholder="0000" id="">
                        <label for="">년</label>
                        <input type="number" name="user_birthMonth" maxlength="2" min="1" max="12" placeholder="00" id="">
                        <label for="">월</label>
                        <input type="number" name="user_birthDate" maxlength="2" min="1" max="31" placeholder="00" id="">
                        <label for="">일</label>
                      </div>
                      <div class="user_phone">
                        <label for="">전화번호</label>
                        <input type="tel" name="user_phone" maxlength="20" placeholder="' - ' 빼고 입력하세요." id="">
                      </div>
                      <div class="user_email">
                        <label for="">이메일</label>
                        <input type="email" name="user_email" placeholder="ex. example@example.com" id="">
                      </div>
                      <div class="user_nationality_select">
                        <label for="">국가</label>
                        <input type="text" name="user_nationality" id="" placeholder="국가 선택" readonly>
                        <ul>
                          <li><a href="#none">대한민국</a></li>
                          <li><a href="#none">미국</a></li>
                          <li><a href="#none">오스트레일리아</a></li>
                          <li><a href="#none">일본</a></li>
                          <li><a href="#none">홍콩</a></li>
                          <li><a href="#none">중국</a></li>
                          <li><a href="#none">대만</a></li>
                          <li><a href="#none">싱가포르</a></li>
                          <li><a href="#none">오스트리아</a></li>
                          <li><a href="#none">필리핀</a></li>
                          <li><a href="#none">말레이시아</a></li>
                          <li><a href="#none">영국</a></li>
                          <li><a href="#none">태국</a></li>
                        </ul>
                      </div>
                      <div class="user_states">
                        <label for="">도/특별시/시</label>
                        <input type="text" name="user_states" id="">
                      </div>
                      <div class="user_city">
                        <label for="">시/군/구</label>
                        <input type="text" name="user_city" id="">
                      </div>
                      <div class="user_photo">
                        <input type="hidden" name="user_photo" class="user_photo_submitOnly">
                        <div class="user_photo_img_wrap">
                          <canvas class="user_photo_canvas" width="0" height="0"></canvas>
                          <div class="user_photo_cut">
                            <div class="user_photo_cut_size"></div>
                          </div>
                        </div>
                        <div class="user_photo_input">
                          <input type="file" name="" class="af02_user_photo" accept="image/png, image/jpeg, image/webp" style="display:none">
                          <a href="#none">파일 열기</a>
                          <a href="#none">잘라내기</a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </fieldset>

          <fieldset class="season_fieldset06 total_price_wrap">
            <legend>가격 합계</legend>
            <div class="sf06_discount">
              <span>할인 적용</span>
              <ul class="sf06_d_list">
                <li class="empty_li">관련 혜택 없음</li>
              </ul>
            </div>

            <div class="sf06_price">
              <div class="sf06_p_selectlist">
                <ul>
                  
                  <li>
                    <span><strong>구매 수량</strong></span>
                    <div class="sf06_p_s_numbers">
                      <div class="sf06_p_s_n_standard">
                        <span class="sf06_p_s_n_title">STANDARD PASS</span>
                        <span class="sf06_p_s_n_number"></span>
                        <span class="sf06_p_s_n_price"></span>
                      </div>
                      <div class="sf06_p_s_n_gold">
                        <span class="sf06_p_s_n_title">GOLD PASS</span>
                        <span class="sf06_p_s_n_number"></span>
                        <span class="sf06_p_s_n_price"></span>
                      </div>
                      <div class="sf06_p_s_n_platinum">
                        <span class="sf06_p_s_n_title">PLATINUM PASS</span>
                        <span class="sf06_p_s_n_number"></span>
                        <span class="sf06_p_s_n_price"></span>
                      </div>
                    </div>
                  </li>
                  <li>
                    <span><strong>할인 내역</strong></span>
                    <div class="sf06_p_s_discount">
                      <div>
                        <p class="sf06_p_s_e_title06"></p>
                        <p class="sf06_p_s_e_number06"></p>
                        <p class="sf06_p_s_e_price06"></p>
                      </div>
                    </div>
                  </li>
                </ul>
              </div>
              <div class="sf06_p_total">
                <label for="season_total_price">합계</label>
                <span class="sf06_p_t_text"></span>
                <input type="text" name="season_total_price" id="season_total_price" readonly class="total_price">
              </div>
              <div class="season_ticket_submit ticket_submit">
                <button type="submit" class="submit_btn">장바구니에 담기</button>
                <button type="button" class="reset_btn">다시 입력</button>
              </div>
            </div>
          </fieldset>
        </form>
    </div>
    <script>
        $(function(){
            
            // for Total Price ----------
            var discountRate = 1;
            var sf01_price = [0,0,0];
            var af04_price = [0,0,0];
          //------------Load-------------
          $(".decrease_btn").click(function(e){
            if( $(this).siblings("input").val() > 0) {
              $(this).siblings("input").val((i,v) => +v-1);
              $(this).siblings("input").trigger("change");           
            }
          })
          $(".increase_btn").click(function(e){
            $(this).siblings("input").val((i,v) => +v+1);
            $(this).siblings("input").trigger("change");
          });
          //---------------------------- 01. 이용권 선택 
            $(".sf01_e_list dt a").each(function(i){
              $(this).click(function(){
                $(".sf01_e_l_detail").eq(i).slideToggle();
                $(".sf01_e_l_detail").not(`:eq(${i})`).slideUp();
              })
            });
            $(".sf01_exp > a").click(function(){
              $(".sf01_e_listWrap").slideToggle();
            });

            $(".sf01_tc_number input").each(function(i){
              const $newDiv = $("<div><p class='sf06_p_s_n_title'></p><p class='sf06_p_s_n_number'></p><p class='sf06_p_s_n_price'></p></div>");
              $(".sf06_p_s_numbers").append($newDiv);

              $(this).change(function(){
                if ( $(this).val() == 0 ) {
                  $newDiv.hide();
                } else {
                  $newDiv.show()
                  if ( i == 0 ) {
                    const price = 119000;
                    $(".sf06_p_s_n_title").eq(i).text("STANDARD PASS");
                    $(".sf06_p_s_n_number").eq(i).text($(this).val());
                    $(".sf06_p_s_n_price").eq(i).text("￦" + $(this).val() * price);
                    sf01_price[i] = $(this).val() * price;
                  }
                  if ( i == 1 ) {
                    const price = 169000;
                    $(".sf06_p_s_n_title").eq(i).text("GOLD PASS");
                    $(".sf06_p_s_n_number").eq(i).text($(this).val());
                    $(".sf06_p_s_n_price").eq(i).text("￦" + $(this).val() * price);
                    sf01_price[i] = $(this).val() * price;
                  }
                  if ( i == 2 ) {
                    const price = 249000;
                    $(".sf06_p_s_n_title").eq(i).text("PLATINUM PASS");
                    $(".sf06_p_s_n_number").eq(i).text($(this).val());
                    $(".sf06_p_s_n_price").eq(i).text("￦" + $(this).val() * price);
                    sf01_price[i] = $(this).val() * price;
                  }
                }
                total();
              })
            })
          // ------------------------------------- 02. 정보입력
          
          //photo
          let $w = $(".user_photo_cut").width()/2;
          let $h = $(".user_photo_cut").height()/2;
          // cut control
          $(".user_photo").each(function(i){
            const mousekey = {};
            $(this).find(".user_photo_cut_size")
            .on("mousedown", function(e){
              e.stopPropagation();
              mousekey["r"] = true;
            });
            $(document)
            .on("mouseup",function(){
              mousekey["d"] = false;
              mousekey["r"]=false;
            });
            $(this).children(".user_photo_img_wrap")
              .on("mousedown",".user_photo_cut",function(){
                mousekey["d"] = true;
              })
              .on("mouseleave", function(){
                mousekey["d"] = false;
                mousekey["r"]=false;
              })
              .on("mousemove",function(e){
              //move cut
              const cut = $(this).find(".user_photo_cut");
              const pt = $(this).children("canvas").offset().top, pl = $(this).children("canvas").offset().left, ph = $(this).children("canvas").height(), pw = $(this).children("canvas").width();
              let ex = event.movementX, ey = event.movementY,
                widen = ex*ex > ey*ey? ex : ey;
              let ct = cut.offset().top, cl = cut.offset().left,
                ch = cut.height(), cw = cut.width();
              if(mousekey["d"]){
                if(ct < pt){ cut.offset({top: pt+1}); }
                else if(ct+ch >= pt+ph){ cut.offset({top: pt+ph-ch-1}); }
                else { cut.offset({top: ct+ey}); }

                if(cl < pl){ cut.offset({left: pl+1}); }
                else if(cl+cw >= pl+pw){ cut.offset({left: pl+pw-cw-1}); }
                else { cut.offset({left: cl+ex}); }
              }
              //resize cut
              if(mousekey["r"]){
                if(cl+cw < pl+pw && ct+ch < pt+ph) {
                  cut.css({ width : `+=${widen}`, height: `+=${widen}` })
                } else {
                  cut.css({ width : cw-1, height: ch-1 })
                }
              }
            });
          })
          // 입력창 생성
          function makeInfo(classes) {
              if( $(`.sf02_i_info_${classes}`).length < $(`#season_${classes}_number`).val()) {
                const $makeInfo = $(`.sf02_i_info_origin`).clone(true);
                $makeInfo.addClass([`sf02_i_info_${classes}`, "sf02_i_info"]);
                $makeInfo.removeClass("sf02_i_info_origin");
                $makeInfo.find(".sf02_i_i_t_ticket").text(`${classes.toUpperCase()} PASS`);
                $(".sf02_inputBox").append($makeInfo);

                //제거버튼
                $makeInfo.find(".sf02_i_i_tab a").click(function(){
                  $makeInfo.remove();
                  $(`#season_${classes}_number`).val((i,v) => +v-1);
                });
              
                //국가 선택
                $makeInfo.find(".user_nationality_select input").on("click",function(){
                  $(this).siblings("ul").toggle();
                });
                $makeInfo.find(".user_nationality_select li a").click(function(){
                  $(this).parents(".user_nationality_select").find("input").val((i,v) => $(this).text());
                  $(this).parents(".user_nationality_select").find("ul").slideUp("fast");
                });
                $makeInfo.find(".user_name input").on("change",function(){
                  $makeInfo.find(".sf02_i_i_t_name").text(`사용자 이름 : ${$(this).val()}`);
                })
                // 슬라이드
                $makeInfo.find(".sf02_i_i_tab").on("click",function(){
                  $makeInfo.find(".sf02_i_i_inputpage_wrap").slideToggle();
                })
                //이미지
                $makeInfo.find(".user_photo")
                  .on("click",".user_photo_input a:eq(0)",function(){
                    $(this).siblings(".af02_user_photo").trigger("click");
                  })
                  .on("change",".af02_user_photo",function(event){
                    $makeInfo.find(".user_photo_cut").show();
                    const loader = event.target.files[0];
                    const reader = new FileReader();
                    reader.readAsDataURL(loader);
                    reader.onloadend = function(e){
                      const img = new Image();
                      img.src = e.target.result;
                      const can = $makeInfo.find(".user_photo_canvas");
                      can.data("originUrl",e.target.result);
                      img.onload = function(){
                        const iw = img.width, ih = img.height, max_canvas = can.parent().width();
                        const tw = iw<ih? max_canvas*iw/ih: max_canvas, th = iw<ih? max_canvas: max_canvas*ih/iw;
                        can.prop("width", tw).prop("height",th);
                        const ctx = can.get(0).getContext("2d");
                        ctx.drawImage(img, 0, 0,tw, th );
                      }
                    }
                  })
                  .on("click",".user_photo_input a:eq(1)",function(){
                    const finalCanvasSize = 200;
                    const can = $makeInfo.find(".user_photo_canvas");
                    const draw = can.get(0).getContext("2d");
                      draw.clearRect(0,0,can.width(),can.height());
                    const cut = $makeInfo.find(".user_photo_cut"),
                      ct = cut.position().top, cl = cut.position().left, cw = cut.width(), ch = cut.height(),
                      pw = cut.parent().width(), ph = cut.parent().height();
                    const iii = new Image();
                    iii.src = can.data("originUrl");
                    iii.onload = function(){
                      const iw = iii.width, ih = iii.height
                      can.prop("width", finalCanvasSize).prop("height",finalCanvasSize*cw/ch);
                      draw.drawImage(iii,cl*iw/pw,ct*ih/ph,cw*iw/pw,ch*ih/ph,0,0,finalCanvasSize,finalCanvasSize*cw/ch)
                      const da = can.get(0).toDataURL("image/png");
                      can.data("replaceUrl",da);
                      $makeInfo.find(".user_photo_submitOnly").val((i,v) => da);
                    }
                    
                  })                
                
              }
              // ------------------------------------------
              else if ($(`.sf02_i_info_${classes}`).length > $(`#season_${classes}_number`).val()) {
                $(`.sf02_i_info_${classes}`).last().remove();
              }
          }
          $("#season_standard_number").on("change",function(){
            const price = 119000;
            let n = $(this).val();
            makeInfo("standard");
            $(".sf06_p_s_n_number").eq(0).text(n);
            $(".sf06_p_s_n_price").eq(0).text(n*price);
            if(n==0) {
              $(".sf06_p_s_n_standard").hide();
            } else {
              $(".sf06_p_s_n_standard").show();
            }

          })
          $("#season_gold_number").on("change",function(){
            const price = 169000;
            makeInfo("gold");
            let n = $(this).val();
            $(".sf06_p_s_n_number").eq(1).text(n);
            $(".sf06_p_s_n_price").eq(1).text(n*price);
            if(n==0) {
              $(".sf06_p_s_n_gold").hide();
            } else {
              $(".sf06_p_s_n_gold").show();
            }
          })
          $("#season_platinum_number").on("change",function(){
            const price = 249000;
            makeInfo("platinum")
            let n = $(this).val();
            $(".sf06_p_s_n_number").eq(2).text(n);
            $(".sf06_p_s_n_price").eq(2).text(n*price);
            if(n==0) {
              $(".sf06_p_s_n_platinum").hide();
            } else {
              $(".sf06_p_s_n_platinum").show();
            }
          })


          // ------------------------------------- 06-1. 할인적용
          $(".sf06_d_list li").each(function(i){
            $(this).find(".sf06_d_l_listopen").click(function(){
              $(".sf06_d_l_detail").eq(i).slideToggle();
              $(".sf06_d_l_detail").not(":eq("+i+")").slideUp()
              $(".sf06_d_l_w_exp").eq(i).slideToggle();
              $(".sf06_d_l_w_exp").not(":eq("+i+")").slideDown();
            })
          });

          
          $(".sf06_d_l_select").each(function(i){
            $(this).click(function(){
              $(".sf06_d_list li").eq(i).toggleClass("active_discount");
              $(".sf06_d_list li").not(`:eq(${i})`).removeClass("active_discount");
              $(".sf06_d_list li input:checkbox").eq(i).prop("checked",function(){
                $(".sf06_d_list li input:checkbox").not($(this)).prop("checked",false);
                return !$(this).prop("checked");
              });

              if ( $(".sf06_d_list li input:checkbox").eq(i).is(":checked")) {

                $(".sf06_p_s_discount > div").show();
                if ( i==0 ) {
                  if ($(".sf01_tc_number input").eq(1).val() >= 4 ) {
                    $(".sf06_p_s_e_title06").text("KB국민카드 제휴 할인");
                    $(".sf06_p_s_e_number06").text("GOLD PASS 4장 이상 구매 시 10% 할인")
                    discountRate = 1 - 0.1;
                  } else {
                    alert("GOLD PASS 4장 이상 구매 시 적용 가능합니다.");
                    $(".sf06_d_list li").eq(i).removeClass("active_discount");
                    $(".sf06_d_list li input:checkbox").eq(i).prop("checked",false);
                    discountRate = 1;
                  }
                }    
              } else if (!$(".sf06_d_list li input:checkbox").is(":checked")) {
                $(".sf06_p_s_discount > div").hide();
              }
              
              total();
            });
          });
         

          // ------------------------------------- 06-2. 가격 합산
          
          const total = function() {

            function comma(x) {
              return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            }

            $("#season_total_price").val(function(i,v) {
              if ($(".sf01_tc_number input").eq(1).val() >= 4) {
                sf01_price[1] *= discountRate;
              }
              const t_1 = sf01_price.reduce((a,b) => a+b);
              const t_2 = af04_price.reduce((a,b) => a+b);
              $(".sf06_p_t_text").text("￦"+comma(t_1+t_2));
              
              return t_1 + t_2
            })
            
          }
          

          
          function addBasket(m) {
            const $newBasket = $(`<div id='nb_${m}'></div>`);
            $newBasket.text(localStorage.getItem(`season_ticket_${m}`));
            $newBasket.appendTo($(".rb_list"));
          }
          function aaa(e) {
            const bbb = new FormData(e.target);
            const ccc = Object.fromEntries(bbb.entries());
            const submitTime = Date.now();
            ccc.submitTime = submitTime;
            localStorage.setItem(`season_ticket_${submitTime}`,JSON.stringify(ccc));
            addBasket(submitTime);
          }
          $("#season_ticket_form").submit(function(e){
            e.preventDefault();
            total();
            aaa(e);
          });

          
          //페이지 리셋
        $(".reset_btn").click(function(){
          $(".formBox").load("./t_use_reser01_1.html");
        })
        });
    </script>
   
</body>
</html>